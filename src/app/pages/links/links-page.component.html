<div class="links-page">
  <!-- Cabeçalho -->
  <header class="links-header">
    <div class="links-header-left">
      <h1>Meus Links</h1>
      <p>Gerencie seus links encurtados e organize por coleções.</p>
    </div>

    <button class="btn-primary" (click)="openCreateModal()">
      + Novo Link
    </button>
  </header>

  <!-- Resumo simples -->
  <section class="links-summary">
    <div class="summary-card">
      <span class="summary-label">Total de Links</span>
      <span class="summary-value">{{ links.length }}</span>
    </div>
  </section>

  <!-- Lista de links em cards -->
  <div *ngIf="loading" class="loading">Carregando links...</div>

  <section class="links-list" *ngIf="!loading && links.length; else emptyState">
    <article class="link-card" *ngFor="let link of links">
      <div class="link-left">
        <div class="link-color-bar"></div>

        <div class="link-info">
          <div class="link-title">{{ link.title || 'Sem título' }}</div>

          <div class="link-short" [title]="link.short_url || link.url">
            {{ link.short_url || link.url }}
          </div>

          <div class="link-original" [title]="link.url">
            {{ link.url }}
          </div>

          <div class="link-meta">
            <span class="meta-pill">Cliques: {{ link.clicks || 0 }}</span>
          </div>

          <div class="tags-row" *ngIf="link.tags?.length">
            <span class="tag-pill" *ngFor="let tag of link.tags">
              {{ tag }}
            </span>
          </div>
        </div>
      </div>

      <div class="link-actions">
        <button class="icon-button" title="Copiar link" (click)="copyShortUrl(link)">
          Copiar
        </button>
        <button class="icon-button" title="Editar" (click)="openEditModal(link)">
          Editar
        </button>
        <button class="icon-button danger" title="Excluir" (click)="deleteLink(link)">
          Excluir
        </button>
      </div>
    </article>
  </section>

  <ng-template #emptyState>
    <p class="empty-state">
      Nenhum link cadastrado ainda. Clique em “Novo Link” para criar o primeiro.
    </p>
  </ng-template>

  <!-- MODAL -->
  <div class="modal-backdrop" *ngIf="isModalOpen">
    <div class="modal">
      <div class="modal-header">
        <h2>{{ editingLink ? 'Editar Link' : 'Novo Link' }}</h2>
        <button class="modal-close" type="button" (click)="closeModal()">✕</button>
      </div>

      <form [formGroup]="linkForm" (ngSubmit)="saveLink()">
        <label>
          Título
          <input type="text" formControlName="title" />
        </label>

        <label>
          URL original
          <input type="url" formControlName="url" />
        </label>

        <label>
          Tags (separadas por vírgula)
          <input type="text" formControlName="tagsText" />
        </label>

        <div class="modal-footer">
          <button type="button" (click)="closeModal()">Cancelar</button>
          <button type="submit" [disabled]="linkForm.invalid || saving">
            {{ saving ? 'Salvando...' : 'Salvar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
